(function(){var b=0,h=[],j={},e={},a={"<":"lt",">":"gt","&":"amp",'"':"quot","'":"#39"},i=/[<>&\"\']/g;function d(){this.returnValue=false}function g(){this.cancelBubble=true}(function(k){var l=k.split(/,/),m,o,n;for(m=0;m<l.length;m+=2){n=l[m+1].split(/ /);for(o=0;o<n.length;o++){e[n[o]]=l[m]}}})("application/msword,doc dot,application/pdf,pdf,application/pgp-signature,pgp,application/postscript,ps ai eps,application/rtf,rtf,application/vnd.ms-excel,xls xlb,application/vnd.ms-powerpoint,ppt pps pot,application/zip,zip,application/x-shockwave-flash,swf swfl,application/vnd.openxmlformats,docx pptx xlsx,audio/mpeg,mpga mpega mp2 mp3,audio/x-wav,wav,image/bmp,bmp,image/gif,gif,image/jpeg,jpeg jpg jpe,image/png,png,image/svg+xml,svg svgz,image/tiff,tiff tif,text/html,htm html xhtml,text/rtf,rtf,video/mpeg,mpeg mpg mpe,video/quicktime,qt mov,video/x-flv,flv,video/vnd.rn-realvideo,rv,text/plain,asc txt text diff log,application/octet-stream,exe");var c={STOPPED:1,STARTED:2,QUEUED:1,UPLOADING:2,FAILED:4,DONE:5,GENERIC_ERROR:-100,HTTP_ERROR:-200,IO_ERROR:-300,SECURITY_ERROR:-400,mimeTypes:e,extend:function(k){c.each(arguments,function(l,m){if(m>0){c.each(l,function(o,n){k[n]=o})}});return k},cleanName:function(k){var l,m;m=[/[\300-\306]/g,"A",/[\340-\346]/g,"a",/\307/g,"C",/\347/g,"c",/[\310-\313]/g,"E",/[\350-\353]/g,"e",/[\314-\317]/g,"I",/[\354-\357]/g,"i",/\321/g,"N",/\361/g,"n",/[\322-\330]/g,"O",/[\362-\370]/g,"o",/[\331-\334]/g,"U",/[\371-\374]/g,"u"];for(l=0;l<m.length;l+=2){k=k.replace(m[l],m[l+1])}k=k.replace(/\s+/g,"_");k=k.replace(/[^a-z0-9_\-\.]+/gi,"");return k},addRuntime:function(k,l){l.name=k;h[k]=l;h.push(l);return l},guid:function(){var k=new Date().getTime().toString(32),l;for(l=0;l<5;l++){k+=Math.floor(Math.random()*65535).toString(32)}return(c.guidPrefix||"p")+k+(b++).toString(32)},buildUrl:function(l,k){var m="";c.each(k,function(o,n){m+=(m?"&":"")+escape(n)+"="+escape(o)});if(m){l+=(l.indexOf("?")>0?"&":"?")+m}return l},each:function(o,p){var n,m,l,k;if(o){n=o.length;if(n===m){for(l in o){if(o.hasOwnProperty(l)){if(p(o[l],l)===false){return}}}}else{for(k=0;k<n;k++){if(p(o[k],k)===false){return}}}}},formatSize:function(k){if(k>1048576){return Math.round(k/1048576,1)+" MB"}if(k>1024){return Math.round(k/1024,1)+" KB"}return k+" b"},getPos:function(l,p){var q=0,o=0,s,r=document,m,n;l=l;p=p||r.body;function k(w){var u,v,t=0,z=0;if(w){v=w.getBoundingClientRect();u=r.compatMode==="CSS1Compat"?r.documentElement:r.body;t=v.left+u.scrollLeft;z=v.top+u.scrollTop}return{x:t,y:z}}if(l.getBoundingClientRect&&(navigator.userAgent.indexOf("MSIE")>0&&r.documentMode!==8)){m=k(l);n=k(p);return{x:m.x-n.x,y:m.y-n.y}}s=l;while(s&&s!=p&&s.nodeType){q+=s.offsetLeft||0;o+=s.offsetTop||0;s=s.offsetParent}s=l.parentNode;while(s&&s!=p&&s.nodeType){q-=s.scrollLeft||0;o-=s.scrollTop||0;s=s.parentNode}return{x:q,y:o}},getSize:function(k){return{w:k.clientWidth||k.offsetWidth,h:k.clientHeight||k.offsetHeight}},parseSize:function(k){var l;if(typeof(k)=="string"){k=/^([0-9]+)([mgk]+)$/.exec(k.toLowerCase().replace(/[^0-9mkg]/g,""));l=k[2];k=+k[1];if(l=="g"){k*=1073741824}if(l=="m"){k*=1048576}if(l=="k"){k*=1024}}return k},xmlEncode:function(k){return k?(""+k).replace(i,function(l){return a[l]?"&"+a[l]+";":l}):k},toArray:function(m){var l,k=[];for(l=0;l<m.length;l++){k[l]=m[l]}return k},addI18n:function(k){return c.extend(j,k)},translate:function(k){return j[k]||k},addEvent:function(l,k,m){if(l.attachEvent){l.attachEvent("on"+k,function(){var n=window.event;if(!n.target){n.target=n.srcElement}n.preventDefault=d;n.stopPropagation=g;m(n)})}else{if(l.addEventListener){l.addEventListener(k,m,false)}}}};c.Uploader=function(n){var l={},q,p=[],r,m;q=new c.QueueProgress();n=c.extend({chunk_size:0,max_file_size:"1gb",multi_selection:true,filters:[{title:"Image files",extensions:"jpg,gif,png"}]},n);function o(){var s;if(this.state==c.STARTED&&r<p.length){s=p[r++];if(s.status==c.QUEUED){this.trigger("UploadFile",s)}else{o.call(this)}}else{this.stop()}}function k(){var s;q.reset();for(s=0;s<p.length;s++){q.size+=p[s].size;q.loaded+=p[s].loaded;if(p[s].status==c.DONE){q.uploaded++}else{if(p[s].status==c.FAILED){q.failed++}else{q.queued++}}}q.percent=q.size>0?Math.ceil(q.loaded/q.size*100):0;q.bytesPerSec=Math.ceil(q.loaded/((+new Date()-m||1)/1000))}c.extend(this,{state:c.STOPPED,features:{},files:p,settings:n,total:q,id:c.guid(),init:function(){var x=this,y,u,t,w=0,v;n.page_url=n.page_url||document.location.pathname.replace(/\/[^\/]+$/g,"/");if(!/^(\w+:\/\/|\/)/.test(n.url)){n.url=n.page_url+n.url}n.chunk_size=c.parseSize(n.chunk_size);n.max_file_size=c.parseSize(n.max_file_size);x.bind("FilesAdded",function(z,C){var B,A,D=0;for(B=0;B<C.length;B++){A=C[B];A.loaded=0;A.percent=0;A.status=c.QUEUED;if(C[B].size<=n.max_file_size){p.push(A);D++}}if(D){x.trigger("QueueChanged");x.refresh()}});if(n.unique_names){x.bind("UploadFile",function(z,A){A.target_name=A.id+".tmp"})}x.bind("UploadProgress",function(z,A){if(A.status==c.QUEUED){A.status=c.UPLOADING}A.percent=A.size>0?Math.ceil(A.loaded/A.size*100):0;k()});x.bind("StateChanged",function(z){if(z.state==c.STARTED){m=(+new Date())}});x.bind("QueueChanged",k);x.bind("Error",function(z,A){if(A.file){A.file.status=c.FAILED}});x.bind("FileUploaded",function(z,A){A.status=c.DONE;z.trigger("UploadProgress",A);o.call(x)});if(n.runtimes){u=[];v=n.runtimes.split(/\s?,\s?/);for(y=0;y<v.length;y++){if(h[v[y]]){u.push(h[v[y]])}}}else{u=h}function s(){var z=u[w++];if(z){z.init(x,function(A){if(A&&A.success){x.trigger("Init",{runtime:z.name});x.trigger("PostInit");x.refresh()}else{s()}})}}s()},refresh:function(){this.trigger("Refresh")},start:function(){if(this.state!=c.STARTED){r=0;this.state=c.STARTED;this.trigger("StateChanged");o.call(this)}},stop:function(){if(this.state!=c.STOPPED){this.state=c.STOPPED;this.trigger("StateChanged")}},getFile:function(t){var s;for(s=p.length-1;s>=0;s--){if(p[s].id===t){return p[s]}}},removeFile:function(t){var s;for(s=p.length-1;s>=0;s--){if(p[s].id===t.id){return this.splice(s,1)[0]}}},splice:function(u,s){var t;t=p.splice(u,s);this.trigger("FilesRemoved",t);this.trigger("QueueChanged");return t},trigger:function(t){var v=l[t.toLowerCase()],u,s;if(v){s=Array.prototype.slice.call(arguments);s[0]=this;for(u=0;u<v.length;u++){if(v[u].func.apply(v[u].scope,s)===false){return false}}}return true},bind:function(s,u,t){var v;s=s.toLowerCase();v=l[s]||[];v.push({func:u,scope:t||this});l[s]=v},unbind:function(s,u){var v=l[s.toLowerCase()],t;if(v){for(t=v.length-1;t>=0;t--){if(v[t].func===u){v.splice(t,1)}}}}})};c.File=function(n,l,m){var k=this;k.id=n;k.name=l;k.size=m;k.loaded=0;k.percent=0;k.status=0};c.Runtime=function(){this.init=function(k,l){}};c.QueueProgress=function(){var k=this;k.size=0;k.loaded=0;k.uploaded=0;k.failed=0;k.queued=0;k.percent=0;k.bytesPerSec=0;k.reset=function(){k.size=k.loaded=k.uploaded=k.failed=k.queued=k.percent=k.bytesPerSec=0}};c.runtimes={};window.plupload=c})();(function(b){var c={};function a(j,e,l,k,d){var m,h,g,i;h=google.gears.factory.create("beta.canvas");h.decode(j);i=Math.min(e/h.width,l/h.height);if(i<1){e=Math.round(h.width*i);l=Math.round(h.height*i)}else{e=h.width;l=h.height}h.resize(e,l);return h.encode(d,{quality:k/100})}b.runtimes.Gears=b.addRuntime("gears",{init:function(h,j){var i;if(!window.google||!google.gears){return j({success:false})}try{i=google.gears.factory.create("beta.desktop")}catch(g){return j({success:false})}function d(l){var k,e,m=[],n;for(e=0;e<l.length;e++){k=l[e];n=b.guid();c[n]=k.blob;m.push(new b.File(n,k.name,k.blob.length))}h.trigger("FilesAdded",m)}h.bind("PostInit",function(){var k=h.settings,e=document.getElementById(k.drop_element);if(e){b.addEvent(e,"dragover",function(l){l.preventDefault()});b.addEvent(e,"drop",function(m){var l=i.getDragData(m,"application/x-gears-files");if(l){d(l.files)}m.preventDefault()});e=0}b.addEvent(document.getElementById(k.browse_button),"click",function(p){var o=[],m,l,n;p.preventDefault();for(m=0;m<k.filters.length;m++){n=k.filters[m].extensions.split(",");for(l=0;l<n.length;l++){o.push("."+n[l])}}i.openFiles(d,{singleFile:!k.multi_selection,filter:o})})});h.bind("UploadFile",function(p,m){var r=0,q,n,o=0,l=p.settings.resize,e;n=p.settings.chunk_size;e=n>0;q=Math.ceil(m.size/n);if(!e){n=m.size;q=1}if(l&&/\.(png|jpg|jpeg)$/i.test(m.name)){c[m.id]=a(c[m.id],l.width,l.height,l.quality||90,/\.png$/i.test(m.name)?"image/png":"image/jpeg")}m.size=c[m.id].length;function k(){var v,x,t=p.settings.multipart,s=0,w={name:m.target_name||m.name};function u(z){var y,D="----pluploadboundary"+b.guid(),B="--",C="\r\n",A;if(t){v.setRequestHeader("Content-Type","multipart/form-data; boundary="+D);y=google.gears.factory.create("beta.blobbuilder");b.each(p.settings.multipart_params,function(F,E){y.append(B+D+C+'Content-Disposition: form-data; name="'+E+'"'+C+C);y.append(F+C)});y.append(B+D+C+'Content-Disposition: form-data; name="file"; filename="'+m.name+'"'+C+"Content-Type: application/octet-stream"+C+C);y.append(z);y.append(C+B+D+B+C);A=y.getAsBlob();s=A.length-z.length;z=A}v.send(z)}if(m.status==b.DONE||m.status==b.FAILED||p.state==b.STOPPED){return}if(e){w.chunk=r;w.chunks=q}x=Math.min(n,m.size-(r*n));v=google.gears.factory.create("beta.httprequest");v.open("POST",b.buildUrl(p.settings.url,w));if(!t){v.setRequestHeader("Content-Disposition",'attachment; filename="'+m.name+'"');v.setRequestHeader("Content-Type","application/octet-stream")}v.upload.onprogress=function(y){m.loaded=o+y.loaded-s;p.trigger("UploadProgress",m)};v.onreadystatechange=function(){var y;if(v.readyState==4){if(v.status==200){y={chunk:r,chunks:q,response:v.responseText,status:v.status};p.trigger("ChunkUploaded",m,y);if(y.cancelled){m.status=b.FAILED;return}o+=x;if(++r>=q){m.status=b.DONE;p.trigger("FileUploaded",m,{response:v.responseText,status:v.status})}else{k()}}else{p.trigger("Error",{code:b.HTTP_ERROR,message:"HTTP Error.",file:m,chunk:r,chunks:q,status:v.status})}}};if(r<q){u(c[m.id].slice(r*n,x))}}k()});h.features={dragdrop:true,jpgresize:true,pngresize:true,chunks:true};j({success:true})}})})(plupload);(function(c){var a={};function b(m){var l,k=typeof m,j,e,h,g;if(k==="string"){l="\bb\tt\nn\ff\rr\"\"''\\\\";return'"'+m.replace(/([\u0080-\uFFFF\x00-\x1f\"])/g,function(o,n){var i=l.indexOf(n);if(i+1){return"\\"+l.charAt(i+1)}o=n.charCodeAt().toString(16);return"\\u"+"0000".substring(o.length)+o})+'"'}if(k=="object"){e=m.length!==j;l="";if(e){for(h=0;h<m.length;h++){if(l){l+=","}l+=b(m[h])}l="["+l+"]"}else{for(g in m){if(m.hasOwnProperty(g)){if(l){l+=","}l+=b(g)+":"+b(m[g])}}l="{"+l+"}"}return l}if(m===j){return"null"}return""+m}function d(p){var s=false,g=null,l=null,h,i,j,r,k,n=0;try{try{l=new ActiveXObject("AgControl.AgControl");if(l.IsVersionSupported(p)){s=true}l=null}catch(o){var m=navigator.plugins["Silverlight Plug-In"];if(m){h=m.description;if(h==="1.0.30226.2"){h="2.0.30226.2"}i=h.split(".");while(i.length>3){i.pop()}while(i.length<4){i.push(0)}j=p.split(".");while(j.length>4){j.pop()}do{r=parseInt(j[n],10);k=parseInt(i[n],10);n++}while(n<j.length&&r===k);if(r<=k&&!isNaN(r)){s=true}}}}catch(q){s=false}return s}c.silverlight={trigger:function(k,g){var j=a[k],h,e;if(j){e=c.toArray(arguments).slice(1);e[0]="Silverlight:"+g;setTimeout(function(){j.trigger.apply(j,e)},0)}}};c.runtimes.Silverlight=c.addRuntime("silverlight",{init:function(m,n){var l,j="",k=m.settings.filters,h,g=document.body;if(!d("2.0.31005.0")||(window.opera&&window.opera.buildNumber)){n({success:false});return}a[m.id]=m;l=document.createElement("div");l.id=m.id+"_silverlight_container";c.extend(l.style,{position:"absolute",top:"0",background:m.settings.shim_bgcolor||"transparent",width:"100px",height:"100px",zIndex:99999,opacity:m.settings.shim_bgcolor?"":0.01});l.className="plupload silverlight";if(m.settings.container){g=document.getElementById(m.settings.container);g.style.position="relative"}g.appendChild(l);for(h=0;h<k.length;h++){j+=(j!=""?"|":"")+k[h].title+" | *."+k[h].extensions.replace(/,/g,";*.")}l.innerHTML='<object id="'+m.id+'_silverlight" data="data:application/x-silverlight," type="application/x-silverlight-2" style="outline:none;" width="100%" height="100%"><param name="source" value="'+m.settings.silverlight_xap_url+'"/><param name="background" value="Transparent"/><param name="windowless" value="true"/><param name="initParams" value="id='+m.id+",filter="+j+'"/></object>';function e(){return document.getElementById(m.id+"_silverlight").content.Upload}m.bind("Silverlight:Init",function(){var i,o={};m.bind("Silverlight:StartSelectFiles",function(p){i=[]});m.bind("Silverlight:SelectFile",function(p,s,q,r){var t;t=c.guid();o[t]=s;o[s]=t;i.push(new c.File(t,q,r))});m.bind("Silverlight:SelectSuccessful",function(){if(i.length){m.trigger("FilesAdded",i)}});m.bind("Silverlight:UploadChunkError",function(p,s,q,t,r){m.trigger("Error",{code:c.IO_ERROR,message:"IO Error.",details:r,file:p.getFile(o[s])})});m.bind("Silverlight:UploadFileProgress",function(p,t,q,s){var r=p.getFile(o[t]);r.size=s;r.loaded=q;p.trigger("UploadProgress",r)});m.bind("Refresh",function(p){var q,r,s;q=document.getElementById(p.settings.browse_button);r=c.getPos(q,document.getElementById(p.settings.container));s=c.getSize(q);c.extend(document.getElementById(p.id+"_silverlight_container").style,{top:r.y+"px",left:r.x+"px",width:s.w+"px",height:s.h+"px"})});m.bind("Silverlight:UploadChunkSuccessful",function(p,s,q,v,u){var t,r=p.getFile(o[s]);t={chunk:q,chunks:v,response:u};p.trigger("ChunkUploaded",r,t);if(r.status==c.FAILED){e().CancelUpload()}});m.bind("Silverlight:UploadSuccessful",function(p,s,q){var r=p.getFile(o[s]);r.status=c.DONE;p.trigger("FileUploaded",r,{response:q})});m.bind("FilesRemoved",function(p,r){var q;for(q=0;q<r.length;q++){e().RemoveFile(o[r[q].id])}});m.bind("UploadFile",function(p,r){var s=p.settings,q=s.resize||{};e().UploadFile(o[r.id],c.buildUrl(p.settings.url,{name:r.target_name||r.name}),b({chunk_size:s.chunk_size,image_width:q.width,image_height:q.height,image_quality:q.quality||90,multipart:!!s.multipart,multipart_params:s.multipart_params||{}}))});n({success:true})})}})})(plupload);(function(c){var a={};function b(){var d;try{d=navigator.plugins["Shockwave Flash"];d=d.description}catch(g){try{d=new ActiveXObject("ShockwaveFlash.ShockwaveFlash").GetVariable("$version")}catch(e){d="0.0"}}d=d.match(/\d+/g);return parseFloat(d[0]+"."+d[1])}c.flash={trigger:function(g,d,e){setTimeout(function(){var k=a[g],j,h;if(k){k.trigger("Flash:"+d,e)}},0)}};c.runtimes.Flash=c.addRuntime("flash",{init:function(h,m){var l,g,i,e,n=0,d=document.body;if(b()<10){m({success:false});return}a[h.id]=h;l=document.getElementById(h.settings.browse_button);g=document.createElement("div");g.id=h.id+"_flash_container";c.extend(g.style,{position:"absolute",top:"0px",background:h.settings.shim_bgcolor||"transparent",zIndex:99999,width:"100%",height:"100%"});g.className="plupload flash";if(h.settings.container){d=document.getElementById(h.settings.container);d.style.position="relative"}d.appendChild(g);i="id="+escape(h.id);g.innerHTML='<object id="'+h.id+'_flash" width="100%" height="100%" style="outline:0" type="application/x-shockwave-flash" data="'+h.settings.flash_swf_url+'"><param name="movie" value="'+h.settings.flash_swf_url+'" /><param name="flashvars" value="'+i+'" /><param name="wmode" value="transparent" /><param name="allowscriptaccess" value="always" /></object>';function k(){return document.getElementById(h.id+"_flash")}function j(){if(n++>5000){m({success:false});return}if(!e){setTimeout(j,1)}}j();l=g=null;h.bind("Flash:Init",function(){var r={},p,q=h.settings.filters,o=h.settings.resize||{};e=true;f=[];for(p=0;p<q.length;p++){f[p]={title:q[p].title,extensions:"*."+q[p].extensions.replace(/,/g,";*.")}}k().setFileFilters(f,h.settings.multi_selection);h.bind("UploadFile",function(s,t){var u=s.settings;k().uploadFile(r[t.id],c.buildUrl(u.url,{name:t.target_name||t.name}),{chunk_size:u.chunk_size,width:o.width,height:o.height,quality:o.quality||90,multipart:u.multipart,multipart_params:u.multipart_params,format:/\.(jpg|jpeg)$/i.test(t.name)?"jpg":"png"})});h.bind("Flash:UploadProcess",function(t,s){var u=t.getFile(r[s.id]);u.loaded=s.loaded;u.size=s.size;t.trigger("UploadProgress",u)});h.bind("Flash:UploadChunkComplete",function(s,u){var v,t=s.getFile(r[u.id]);v={chunk:u.chunk,chunks:u.chunks,response:u.text};s.trigger("ChunkUploaded",t,v);if(t.status==c.FAILED){k().cancelUpload()}});h.bind("Flash:UploadComplete",function(t,s){var u=t.getFile(r[s.id]);u.status=c.DONE;t.trigger("FileUploaded",u,{response:s.text})});h.bind("Flash:SelectFiles",function(s,v){var u,t,w=[],x;for(t=0;t<v.length;t++){u=v[t];x=c.guid();r[x]=u.id;r[u.id]=x;w.push(new c.File(x,u.name,u.size))}if(w.length){h.trigger("FilesAdded",w)}});h.bind("Flash:SecurityError",function(s,t){h.trigger("Error",{code:c.SECURITY_ERROR,message:"Security error.",details:t.message,file:h.getFile(r[t.id])})});h.bind("Flash:GenericError",function(s,t){h.trigger("Error",{code:c.GENERIC_ERROR,message:"Generic error.",details:t.message,file:h.getFile(r[t.id])})});h.bind("Flash:IOError",function(s,t){h.trigger("Error",{code:c.IO_ERROR,message:"IO error.",details:t.message,file:h.getFile(r[t.id])})});h.bind("QueueChanged",function(s){h.refresh()});h.bind("FilesRemoved",function(s,u){var t;for(t=0;t<u.length;t++){k().removeFile(r[u[t].id])}});h.bind("StateChanged",function(s){h.refresh()});h.bind("Refresh",function(s){var t,u,v;t=document.getElementById(s.settings.browse_button);u=c.getPos(t,document.getElementById(s.settings.container));v=c.getSize(t);c.extend(document.getElementById(s.id+"_flash_container").style,{top:u.y+"px",left:u.x+"px",width:v.w+"px",height:v.h+"px"})});m({success:true})})}})})(plupload);(function(a){a.runtimes.BrowserPlus=a.addRuntime("browserplus",{init:function(h,j){var e=window.BrowserPlus,i={},d=h.settings,c=d.resize;function g(o){var n,m,k=[],l,p;for(m=0;m<o.length;m++){l=o[m];p=a.guid();i[p]=l;k.push(new a.File(p,l.name,l.size))}if(m){h.trigger("FilesAdded",k)}}function b(){h.bind("PostInit",function(){var n,l=d.drop_element,p=h.id+"_droptarget",k=document.getElementById(l),m;function q(s,r){e.DragAndDrop.AddDropTarget({id:s},function(t){e.DragAndDrop.AttachCallbacks({id:s,hover:function(u){if(!u&&r){r()}},drop:function(u){if(r){r()}g(u)}},function(){})})}function o(){document.getElementById(p).style.top="-1000px"}if(k){if(document.attachEvent&&(/MSIE/gi).test(navigator.userAgent)){n=document.createElement("div");n.setAttribute("id",p);a.extend(n.style,{position:"absolute",top:"-1000px",background:"red",filter:"alpha(opacity=0)",opacity:0});document.body.appendChild(n);a.addEvent(k,"dragenter",function(s){var r,t;r=document.getElementById(l);t=a.getPos(r);a.extend(document.getElementById(p).style,{top:t.y+"px",left:t.x+"px",width:r.offsetWidth+"px",height:r.offsetHeight+"px"})});q(p,o)}else{q(l)}}a.addEvent(document.getElementById(d.browse_button),"click",function(w){var u=[],s,r,v=d.filters,t;w.preventDefault();for(s=0;s<v.length;s++){t=v[s].extensions.split(",");for(r=0;r<t.length;r++){u.push(a.mimeTypes[t[r]])}}e.FileBrowse.OpenBrowseDialog({mimeTypes:u},function(x){if(x.success){g(x.value)}})});k=n=null});h.bind("UploadFile",function(o,l){var n=i[l.id],k={},m=o.settings.chunk_size,p,q=[];function s(t,v){var u;if(l.status==a.FAILED){return}k.name=l.target_name||l.name;if(m){k.chunk=t;k.chunks=v}u=q.shift();e.Uploader.upload({url:a.buildUrl(o.settings.url,k),files:{file:u},cookies:document.cookies,postvars:o.settings.multipart_params,progressCallback:function(y){var x,w=0;p[t]=parseInt(y.filePercent*u.size/100,10);for(x=0;x<p.length;x++){w+=p[x]}l.loaded=w;o.trigger("UploadProgress",l)}},function(x){var w,y;if(x.success){w=x.value.statusCode;if(m){o.trigger("ChunkUploaded",l,{chunk:t,chunks:v,response:x.value.body,status:w})}if(q.length>0){s(++t,v)}else{l.status=a.DONE;o.trigger("FileUploaded",l,{response:x.value.body,status:w});if(w!=200){o.trigger("Error",{code:a.HTTP_ERROR,message:"HTTP Error.",file:l,status:w})}}}else{o.trigger("Error",{code:a.GENERIC_ERROR,message:"Generic Error.",file:l,details:x.error})}})}function r(t){l.size=t.size;if(m){e.FileAccess.chunk({file:t,chunkSize:m},function(w){if(w.success){var x=w.value,u=x.length;p=Array(u);for(var v=0;v<u;v++){p[v]=0;q.push(x[v])}s(0,u)}})}else{p=Array(1);q.push(t);s(0,1)}}if(c&&/\.(png|jpg|jpeg)$/i.test(l.name)){BrowserPlus.ImageAlter.transform({file:n,quality:c.quality||90,actions:[{scale:{maxwidth:c.width,maxheight:c.height}}]},function(t){if(t.success){r(t.value.file)}})}else{r(n)}});h.features={dragdrop:true,jpgresize:true,pngresize:true,chunks:true};j({success:true})}if(e){e.init(function(l){var k=[{service:"Uploader",version:"3"},{service:"DragAndDrop",version:"1"},{service:"FileBrowse",version:"1"},{service:"FileAccess",version:"2"}];if(c){k.push({service:"ImageAlter",version:"4"})}if(l.success){e.require({services:k},function(m){if(m.success){b()}else{j()}})}else{j()}})}else{j()}}})})(plupload);(function(b){function a(j,m,k,c,l){var e,d,i,h,g;e=document.createElement("canvas");e.style.display="none";document.body.appendChild(e);d=e.getContext("2d");i=new Image();i.onload=function(){var p,n,o;g=Math.min(m/i.width,k/i.height);if(g<1){p=Math.round(i.width*g);n=Math.round(i.height*g)}else{p=i.width;n=i.height}e.width=p;e.height=n;d.drawImage(i,0,0,p,n);h=e.toDataURL(c);h=h.substring(h.indexOf("base64,")+7);h=atob(h);e.parentNode.removeChild(e);l({success:true,data:h})};i.src=j}b.runtimes.Html5=b.addRuntime("html5",{init:function(h,i){var c={},e;function g(m){var k,j,l=[],n;for(j=0;j<m.length;j++){k=m[j];n=b.guid();c[n]=k;l.push(new b.File(n,k.fileName,k.fileSize))}if(l.length){h.trigger("FilesAdded",l)}}function d(){var j;if(window.XMLHttpRequest){j=new XMLHttpRequest();return !!(j.sendAsBinary||j.upload)}return false}if(!d()){i({success:false});return}h.bind("Init",function(n){var r,p=[],m,q,k=n.settings.filters,l,o,j=document.body;r=document.createElement("div");r.id=n.id+"_html5_container";for(m=0;m<k.length;m++){l=k[m].extensions.split(/,/);for(q=0;q<l.length;q++){o=b.mimeTypes[l[q]];if(o){p.push(o)}}}b.extend(r.style,{position:"absolute",background:h.settings.shim_bgcolor||"transparent",width:"100px",height:"100px",overflow:"hidden",zIndex:99999,opacity:h.settings.shim_bgcolor?"":0});r.className="plupload html5";if(h.settings.container){j=document.getElementById(h.settings.container);j.style.position="relative"}j.appendChild(r);r.innerHTML='<input id="'+h.id+'_html5" style="width:100%;" type="file" accept="'+p.join(",")+'" '+(h.settings.multi_selection?'multiple="multiple"':"")+" />";document.getElementById(h.id+"_html5").onchange=function(){g(this.files);this.value=""}});h.bind("PostInit",function(){var j=document.getElementById(h.settings.drop_element);if(j){b.addEvent(j,"dragover",function(k){k.preventDefault()});b.addEvent(j,"drop",function(l){var k=l.dataTransfer;if(k&&k.files){g(k.files)}l.preventDefault()})}});h.bind("Refresh",function(j){var k,l,m;k=document.getElementById(h.settings.browse_button);l=b.getPos(k,document.getElementById(j.settings.container));m=b.getSize(k);b.extend(document.getElementById(h.id+"_html5_container").style,{top:l.y+"px",left:l.x+"px",width:m.w+"px",height:m.h+"px"})});h.bind("UploadFile",function(j,m){var q=new XMLHttpRequest(),l=q.upload,k=j.settings.resize,p,o=0;function n(r){var v="----pluploadboundary"+b.guid(),t="--",u="\r\n",s="";if(j.settings.multipart){q.setRequestHeader("Content-Type","multipart/form-data; boundary="+v);b.each(j.settings.multipart_params,function(x,w){s+=t+v+u+'Content-Disposition: form-data; name="'+w+'"'+u+u;s+=x+u});s+=t+v+u+'Content-Disposition: form-data; name="file"; filename="'+m.name+'"'+u+"Content-Type: application/octet-stream"+u+u+r+u+t+v+t+u;o=s.length-r.length;r=s}q.sendAsBinary(r)}if(m.status==b.DONE||m.status==b.FAILED||j.state==b.STOPPED){return}if(l){l.onprogress=function(r){m.loaded=r.loaded-o;j.trigger("UploadProgress",m)}}q.onreadystatechange=function(){var r=q.status;if(q.readyState==4){m.status=b.DONE;m.loaded=m.size;j.trigger("UploadProgress",m);j.trigger("FileUploaded",m,{response:q.responseText,status:r});if(r!=200){j.trigger("Error",{code:b.HTTP_ERROR,message:"HTTP Error.",file:m,status:r})}}};q.open("post",b.buildUrl(j.settings.url,{name:m.target_name||m.name}),true);q.setRequestHeader("Content-Type","application/octet-stream");p=c[m.id];if(q.sendAsBinary){if(k&&/\.(png|jpg|jpeg)$/i.test(m.name)){a(p.getAsDataURL(),k.width,k.height,/\.png$/i.test(m.name)?"image/png":"image/jpeg",function(r){if(r.success){m.size=r.data.length;n(r.data)}else{n(p.getAsBinary())}})}else{n(p.getAsBinary())}}else{q.send(p)}});e=!!(File&&File.prototype.getAsDataURL);h.features={dragdrop:window.mozInnerScreenX!==undefined,jpgresize:e,pngresize:e};i({success:true})}})})(plupload);(function(a){a.runtimes.Html4=a.addRuntime("html4",{init:function(g,h){var d={},c,b;function e(m){var l,k,n=[],o,j;j=m.value.replace(/\\/g,"/");j=j.substring(j.length,j.lastIndexOf("/")+1);o=a.guid();l=new a.File(o,j,1025);d[o]=l;l.input=m;n.push(l);if(n.length){g.trigger("FilesAdded",n)}}g.bind("Init",function(p){var j,x,v,t=[],o,u,n=p.settings.filters,m,s,r=/MSIE/.test(navigator.userAgent),l="javascript",w,k=document.body;if(g.settings.container){k=document.getElementById(g.settings.container);k.style.position="relative"}if(!p.settings.form){j=document.getElementsByTagName("form");if(!j.length){c=document.createElement("form");c.setAttribute("action",p.settings.url);c.setAttribute("target","_self");document.body.appendChild(c)}else{c=j[0]}c.setAttribute("id",c.id||p.id);c.setAttribute("method","post");c.setAttribute("enctype","multipart/form-data")}else{c=(typeof p.settings.form=="string")?document.getElementById(p.settings.form):p.settings.form}a.each(p.settings.multipart_params,function(z,y){var i=document.createElement("input");a.extend(i,{type:"hidden",name:y,value:z});c.appendChild(i)});b=document.createElement("iframe");b.setAttribute("src",l+':""');b.setAttribute("name",p.id+"_iframe");b.setAttribute("id",p.id+"_iframe");b.style.display="none";a.addEvent(b,"load",function(B){var C=B.target,z=g.currentfile,A;try{A=C.contentWindow.document||C.contentDocument||window.frames[C.id].document}catch(y){p.trigger("Error",{code:a.SECURITY_ERROR,message:"Security error.",file:z});return}if(A.location.href=="about:blank"||!z){return}var i=A.documentElement.innerText||A.documentElement.textContent;if(i!=""){z.status=a.DONE;z.loaded=1025;z.percent=100;if(z.input){z.input.removeAttribute("name")}p.trigger("UploadProgress",z);p.trigger("FileUploaded",z,{response:i});if(c.tmpAction){c.action=c.tmpAction}if(c.tmpTarget){c.target=c.tmpTarget}}});c.appendChild(b);if(r){window.frames[b.id].name=b.name}x=document.createElement("div");x.id=p.id+"_iframe_container";for(o=0;o<n.length;o++){m=n[o].extensions.split(/,/);for(u=0;u<m.length;u++){s=a.mimeTypes[m[u]];if(s){t.push(s)}}}a.extend(x.style,{position:"absolute",background:"transparent",width:"100px",height:"100px",overflow:"hidden",zIndex:99999,opacity:0});w=g.settings.shim_bgcolor;if(w){a.extend(x.style,{background:w,opacity:1})}x.className="plupload_iframe";k.appendChild(x);function q(){v=document.createElement("input");v.setAttribute("type","file");v.setAttribute("accept",t.join(","));v.setAttribute("size",1);a.extend(v.style,{width:"100%",height:"100%",opacity:0});if(r){a.extend(v.style,{filter:"alpha(opacity=0)"})}a.addEvent(v,"change",function(i){var y=i.target;if(y.value){q();y.style.display="none";e(y)}});x.appendChild(v);return true}q()});g.bind("Refresh",function(i){var j,k,l;j=document.getElementById(g.settings.browse_button);k=a.getPos(j,document.getElementById(i.settings.container));l=a.getSize(j);a.extend(document.getElementById(g.id+"_iframe_container").style,{top:k.y+"px",left:k.x+"px",width:l.w+"px",height:l.h+"px"})});g.bind("UploadFile",function(i,j){if(j.status==a.DONE||j.status==a.FAILED||i.state==a.STOPPED){return}if(!j.input){j.status=a.ERROR;return}j.input.setAttribute("name","file");c.tmpAction=c.action;c.action=a.buildUrl(i.settings.url,{name:j.target_name||j.name});c.tmpTarget=c.target;c.target=b.name;this.currentfile=j;c.submit()});g.bind("FilesRemoved",function(j,l){var k,m;for(k=0;k<l.length;k++){m=l[k].input;if(m){m.parentNode.removeChild(m)}}});g.features={};h({success:true})}})})(plupload);